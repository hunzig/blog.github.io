<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>安卓手机地理位置信息取证 | hack70</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">安卓手机地理位置信息取证</h1><a id="logo" href="/.">hack70</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">安卓手机地理位置信息取证</h1><div class="post-meta">Apr 26, 2017<span> | </span><span class="category"><a href="/categories/forensics/">forensics</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h3 id="百度地图取证方法"><a href="#百度地图取证方法" class="headerlink" title="百度地图取证方法"></a>百度地图取证方法</h3><p>第一步寻找：对百度地图所有文件进行location、longitude、latitude等关键词扫描，扫描出所含关键词的文件被标记为行踪轨迹文件。再通过正则表达式来检索重点标记文件，当文件有“20.123”类似经纬度数据，则该文件被标记为GPS数据文件。</p>
<p>　　第二步确认：被找到的GPS数据文件里面需要确认哪些文件才是有用的GPS数据文件。通常方法是多次使用百度地图进行定位，百度地图产生的GPS定位数据和时间记录是否和本地坐标、时间保持一致。这样就确认了在找出的GPS文件中哪些是有用数据。</p>
<p>　　第三步判断：被确认的GPS数据之中不确定该GPS数据属于哪种坐标系，接下来就是判断该坐标系是属于哪个坐标系。先大致介绍一下手机中的坐标系大致分为以下几类：</p>
<p>　　l WGS84、GPS：一种国际上采用的地心坐标系，也是原始的坐标系，这是国际公认的世界标准坐标体系。</p>
<p>　　l GCJ-02：又称“火星坐标”它是由中国国家测绘局在02年制订的地理信息系统的坐标系统。它是一种对经纬度数据的加密算法，即加入随机的偏差。在国内，至少使用此地图坐标体系的比如：Google、高德、腾讯等。</p>
<p>　　l 其他特殊坐标体系：一般都是由火星坐标通过偏移算法计算得出的，比如百度使用的是BD-09坐标，搜狗使用的是自己的搜狗坐标。</p>
<p>　　判断被找到确认的GPS数据属于上述哪种坐标系，首先把确认的GPS数据定位点找到地址，再在专业的经纬度地图上对比该地址相对应各个坐标系的经纬度数据，误差在20米之内的坐标系则就是该GPS数据属于的坐标系。百度地图所有的GPS数据都是属于它自己的BD-09坐标系。</p>
<p>　　第四步展示：知道了GPS数据的坐标系，想要在百度地图上的展示该定位点，则需要对GPS数据转化成百度地图上使用的BD-09坐标系。转化方法分为两种：</p>
<p>　　网上坐标接口转化：网上接口转化相对很简单，直接调用网络接口就可以实现转化。</p>
<p>　　代码转化：代码转化主要对每一个坐标系实现互相转化，以下就是GCJ-02转化成BD-09的代码实现方法。
　　</p>
<h3 id="ios-4-x-取证要点"><a href="#ios-4-x-取证要点" class="headerlink" title="ios 4.x 取证要点"></a>ios 4.x 取证要点</h3><p>位置信息存储在clonsolidated.db中，可以显示MCC,MNC,LAC,Cell ID,Latitude,Longitude。对该文件分析可以使用免费软件iStalker。</p>
<h3 id="安卓位置取证"><a href="#安卓位置取证" class="headerlink" title="安卓位置取证"></a>安卓位置取证</h3><p>基站位置信息和wifi位置信息分别存储在cache.cell和cache.wifi两个文件中。<br>存储路径：<br>/data/data/com.google.android.location/files/cache.cell<br>/data/data/com.google.android.location/files/cache.wifi</p>
<h3 id="转换-cache-cell和cache-wifi"><a href="#转换-cache-cell和cache-wifi" class="headerlink" title="转换 cache.cell和cache.wifi"></a>转换 cache.cell和cache.wifi</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cacheFile = open(&quot;cache.wifi&quot;, &apos;rb&apos;)</div><div class="line">version, entries = struct.unpack(&apos;&gt;hh&apos;, cacheFile.read(4))</div><div class="line">i = 0</div><div class="line">while i &lt; entries:</div><div class="line">   key = cacheFile.read(struct.unpack(&apos;&gt;h&apos;, cacheFile.read(2))[0])</div><div class="line">   (accuracy, confidence, latitude, longitude, readtime) = struct.unpack(&apos;&gt;iiddQ&apos;, cacheFile.read(32))</div><div class="line">   outputFile.write(&apos;%25s %7d %5d %10f %10f %s \n&apos; % (key,accuracy,confidence,latitude,longitude,time.strftime(&quot;%x %X %z&quot;, time.localtime(readtime/1000))))</div><div class="line">   i=i+1</div><div class="line">cacheFile.close()</div></pre></td></tr></table></figure>
<p>The cache files are located at:<br>/data/data/com.google.android.location/files/<br>This snippet works for both cache files, just change the filename</p>
<h3 id="利用手机中的位置信息"><a href="#利用手机中的位置信息" class="headerlink" title="利用手机中的位置信息"></a>利用手机中的位置信息</h3><p>　　手机中的位置信息，用户是可以通过相关软件进行查看并直观的展示出来的，这里推荐Location Cache软件，可以看到手机最后接触的50个信号基站和100个WiFi热点，这些全都以Google Map 方式显示。 </p>
<p>参考文章：<br><a href="https://sanwen8.cn/p/7649EG4.html" target="_blank" rel="external">https://sanwen8.cn/p/7649EG4.html</a></p>
<hr>
<h2 id="最新内容："><a href="#最新内容：" class="headerlink" title="最新内容："></a>最新内容：</h2><p><strong>微信：</strong>（基于地址共享）<br>利用工具 SQLCipher.exe 打开 EnMicroMsg.db 数据库文件，输入密码，即可成功打开<br>文件。读取表“message”中记录的聊天记录，使用关键词“location” 执行 SQL 查询语句，从而获取所需的地理位置信息。</p>
<p><strong>百度地图</strong><br>百度地图应用中地理位置信息主要包含用户定位记录、导航记录、步行记录等，这些数据存储在/data/data/com.baidu.BaiduMap/databases 路径下。在众多生成的数据文件中，名为“tracks.db”的数据库文件中各表详细记录使用者相应的地理位置信息。存储用户定位记录的表为 Track_Location。<br>提取方法<br>访问 data/data/com.baidu.BaiduMap/databases 目录，利用数据库查看软件SQLite Expert Professional 即可查看数据库 tracks.db，并导出数据。</p>
<p><strong>滴滴</strong><br>滴滴出行应用的一部分订单信息和用户个人信息以数据库文件的形式存储在data/data/com.sdu.didi.psnger/databases/路径下。在 datebases 中有许多数据库文件和 journal 文件，其中 im_database_281475098446424.db 中存储着有关订单信息。Android_metadata 为 Android 数据库原文件数据，im_message_table 为会话信息，im_user_table 为用户相关的额表信息。<br>提取 im_user_table 表得到的用户与滴滴司机活动信息，然而具体位置信息并未包含于本地数据库中，而是存储在应用服务器上。因此需要使用可视化取证手段提取更多详细信息。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://hack70.com/2017/04/26/042安卓手机位置取证/" data-id="cj1z1uciy00004myj6anojgkc" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2017/04/27/043日志查看相关linux命令/" class="pre">日志查看相关linux命令</a><a href="/2017/04/25/041如何破解微信加密数据库EnMicroMsg.db读取聊天消息/" class="next">如何破解微信加密数据库EnMicroMsg.db读取聊天消息</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://hack70.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/forensics/">forensics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hack/">hack</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/raspberry/" style="font-size: 15px;">raspberry</a> <a href="/tags/wireless/" style="font-size: 15px;">wireless</a> <a href="/tags/免流/" style="font-size: 15px;">免流</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/manjaro/" style="font-size: 15px;">manjaro</a> <a href="/tags/梅林/" style="font-size: 15px;">梅林</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/vps/" style="font-size: 15px;">vps</a> <a href="/tags/genymotion/" style="font-size: 15px;">genymotion</a> <a href="/tags/kali/" style="font-size: 15px;">kali</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/ctf/" style="font-size: 15px;">ctf</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/04/27/043日志查看相关linux命令/">日志查看相关linux命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/26/042安卓手机位置取证/">安卓手机地理位置信息取证</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/25/041如何破解微信加密数据库EnMicroMsg.db读取聊天消息/">如何破解微信加密数据库EnMicroMsg.db读取聊天消息</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/040Vulnhub - Mr. Robot CTF Video Walkthrough/">Vulnhub - Mr. Robot CTF Video Walkthrough</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/039sublime-rumen /">如何优雅地使用sublime</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/032weijizhan-forensics/">伪基站鉴定相关要点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/031kali-forensics/">kali计算机取证——安全牛</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/037change-vps-time /">vps修改时区</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/036yijuhua /">一句话木马</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/035lshack /">lshack拿站实例</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.douban.com/" title="douban" target="_blank">douban</a><ul></ul><a href="http://www.v2ex.com/" title="v2ex" target="_blank">v2ex</a><ul></ul><a href="http://www.github.com/" title="github" target="_blank">github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">hack70.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>