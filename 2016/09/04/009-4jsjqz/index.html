<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>四、计算机取证 | hack70</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">四、计算机取证</h1><a id="logo" href="/.">hack70</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">四、计算机取证</h1><div class="post-meta">Sep 4, 2016<span> | </span><span class="category"><a href="/categories/forensics/">forensics</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>学习笔记</p>
<a id="more"></a>
<h2 id="4-3数据恢复技术：（物理恢复和逻辑恢复）"><a href="#4-3数据恢复技术：（物理恢复和逻辑恢复）" class="headerlink" title="4.3数据恢复技术：（物理恢复和逻辑恢复）"></a>4.3数据恢复技术：（物理恢复和逻辑恢复）</h2><h3 id="删除的文件"><a href="#删除的文件" class="headerlink" title="删除的文件"></a>删除的文件</h3><p>文件目录存在、数据区均完整（文件快速恢复）</p>
<p>文件目录不存在、数据区完整（文件签名恢复）</p>
<p>文件目录不存在、数据区不完整（关键词搜索手工恢复）</p>
<h3 id="文件签名恢复"><a href="#文件签名恢复" class="headerlink" title="文件签名恢复"></a>文件签名恢复</h3><p>取证软件支持从未分配簇中恢复制定类型的文件<br>exe文件 ：  4D 5A<br>office文件 ： D0 CF 11 E0 A1 B1 1A E1 00 00<br>zip文件  : 50 4B 03 04<br>jpg文件： \xFF\xD8\xFF\xE0</p>
<ul>
<li>TXT文件没有特定的文件签名信息</li>
</ul>
<h3 id="分区格式化恢复"><a href="#分区格式化恢复" class="headerlink" title="分区格式化恢复"></a>分区格式化恢复</h3><p><strong>windows文件系统结构</strong><br>fat：DBR+根目录+数据区   （DBR+根目录=FAT表），格式化时FAT表破坏 数据区可恢复<br>NTFS文件系统结构：BOOT  元文件  MFT   MFTMirr   备份DBR （MFT破坏其他绝大多数可恢复）<br>勘察工具里选数据恢复—格式化恢复—选择被格式化盘符（或全选）</p>
<h3 id="分区丢失恢复"><a href="#分区丢失恢复" class="headerlink" title="分区丢失恢复"></a>分区丢失恢复</h3><p><strong>丢失分区原因</strong>: 主引导记录MBR扇区损坏、扩展引导记录EBR扇区损坏、分区误删除、误分区、误ghost<br><strong>丢失分区的恢复方法</strong>：人工寻址手工修复MBR EBR DBR、分析丢失分区工具取证大师 encase ftk xways等软件<br>（添加设备时候勾选恢复丢失分区或数据恢复按钮再选分区恢复）</p>
<h3 id="RAID重组"><a href="#RAID重组" class="headerlink" title="RAID重组"></a>RAID重组</h3><p>RAID0、1、5、6、HP双循环<br>raid0 分块存储、读取速度快、缺点只要一块盘坏数据就损坏<br>raid1 镜像磁盘、存储空间只有一半<br>raid5 校验信息分布存储、存储能力n-1、至少三块一样硬盘、XOR异或运算<br>       raid5重组三要素：类型、顺序、条带大小</p>
<h3 id="碎片重组"><a href="#碎片重组" class="headerlink" title="碎片重组"></a>碎片重组</h3><h3 id="物理修复"><a href="#物理修复" class="headerlink" title="物理修复"></a>物理修复</h3><hr>
<h2 id="4-4加解密技术"><a href="#4-4加解密技术" class="headerlink" title="4.4加解密技术"></a>4.4加解密技术</h2><h3 id="EFS加密技术取证"><a href="#EFS加密技术取证" class="headerlink" title="EFS加密技术取证"></a>EFS加密技术取证</h3><p>文件型加密、分区加密、全盘加密、物理介质加密、信息隐写技术<br>高级属性–选取加密内容一遍保护数据，文件名变成绿色，只针对win下ntfs格式文件系统<br>EFS加密基于公钥策略，如果登录到域环境中，密钥的生成依赖域控制器或者本地计算机（其他用户无权查看）<br><strong>解密方式</strong>：利用加密的用户名和密码登录浏览、利用计算机中备份的证书文件进行解密（证书文件一般也设置了密码）<br><strong>解密过程</strong>：1、先过滤出EFS加密文件，右键点解密，输入密钥<br>2、取证结果中查看个人证书efs.pfx,然后导出，再次导入</p>
<h3 id="加密容器技术取证"><a href="#加密容器技术取证" class="headerlink" title="加密容器技术取证"></a>加密容器技术取证</h3><p>加密容器采用较强加密算法，如对成加密算法AES-256。可创建加密型容器文件、创建分区加密、创建全盘加密<br>常见加密容器文件默认扩展名为：</p>
<ul>
<li>PGP Desktop :  *.pgd  有文件头特征，可通过签名分析发现</li>
<li>TrueCrypt : *.tc   无文件头部和尾部特征</li>
<li>Private Disk : *.dpd  无文件头部特征，只有尾部特征</li>
<li>BestCrypt : *.jbc  有文件头部特征，可通过签名分析发现<br>发现途径： 过滤1GB以上大文件，然后逐一排查。 或利用第三方软件 tchunt</li>
</ul>
<h3 id="bitlocker加密技术取证"><a href="#bitlocker加密技术取证" class="headerlink" title="bitlocker加密技术取证"></a>bitlocker加密技术取证</h3><p>vista系统之后加密方式,支持全盘加密,仅在旗舰版和企业版中支持<br>bitlocker 加密分区头部有固定标识: FVE-FS<br><strong>解密方式</strong>: 利用访问密码 , 利用恢复密钥 , 从内存中提取密钥</p>
<h2 id="4-5-综合分析应用"><a href="#4-5-综合分析应用" class="headerlink" title="4.5 综合分析应用"></a>4.5 综合分析应用</h2><h3 id="散列分析应用"><a href="#散列分析应用" class="headerlink" title="散列分析应用"></a>散列分析应用</h3><p>散列值(电子指纹)<br><strong>哈希库的建立和管理</strong></p>
<ul>
<li>增加哈希库类型</li>
<li>计算样本文件的哈希值</li>
<li>添加样本文件哈希值</li>
</ul>
<p><strong>散列分析应用</strong></p>
<ul>
<li>用以确定文件或磁盘内容是否被修改过</li>
<li>用以鉴别具有特殊意义的文件</li>
<li>确定文件的唯一性</li>
</ul>
<h3 id="计算机动态仿真技术"><a href="#计算机动态仿真技术" class="headerlink" title="计算机动态仿真技术"></a>计算机动态仿真技术</h3><p><strong>动态仿真</strong> :  物理磁盘仿真  ,   磁盘镜像文件仿真<br><strong>计算机仿真操作步骤</strong> : 选择对象  选择系统  参数设置  开始仿真<br><strong>仿真后的取证工作</strong> : 数据采集 \  数据重现 \<br>动态仿真支持绕过win mac linux等操作系统密码</p>
<h3 id="计算机取证分析思路梳理"><a href="#计算机取证分析思路梳理" class="headerlink" title="计算机取证分析思路梳理"></a>计算机取证分析思路梳理</h3><p>创建副本–检材加载–静态取证(常规分析–深度分析)   动态取证( 系统仿真–数据抓包) –检验结果</p>
<ol>
<li>创建副本:制作检材备份**<br>创建的副本还需要进行哈希值校验</li>
<li>检材加载:快速恢复</li>
<li>检材加载: RAID重组</li>
<li>常规分析: 分区检查</li>
<li>常规分析: 分析提取有关涉案线索</li>
<li><p>深度分析: 过滤及关键字搜索</p>
</li>
<li><p>深度分析:加密数据提取<br>提取目标对象中保存的常用的密码密钥进行解密,或使用字典及暴力破解</p>
</li>
<li>系统仿真: 开机环境重现 数据抓包</li>
<li>检验分析报告</li>
</ol>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://hack70.com/2016/09/04/009-4jsjqz/" data-id="cj1rrp6g6000s28yjjfw5yvmn" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2016/09/04/010dSploit/" class="pre">手机内网渗透工具dSploit的简易使用</a><a href="/2016/09/02/008hexo-zhuanyi/" class="next">hexo转移到其他电脑</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://hack70.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/forensics/">forensics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hack/">hack</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/raspberry/" style="font-size: 15px;">raspberry</a> <a href="/tags/wireless/" style="font-size: 15px;">wireless</a> <a href="/tags/免流/" style="font-size: 15px;">免流</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/manjaro/" style="font-size: 15px;">manjaro</a> <a href="/tags/梅林/" style="font-size: 15px;">梅林</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/vps/" style="font-size: 15px;">vps</a> <a href="/tags/genymotion/" style="font-size: 15px;">genymotion</a> <a href="/tags/kali/" style="font-size: 15px;">kali</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/ctf/" style="font-size: 15px;">ctf</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/04/26/042安卓手机位置取证/">安卓手机地理位置信息取证</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/25/041如何破解微信加密数据库EnMicroMsg.db读取聊天消息/">如何破解微信加密数据库EnMicroMsg.db读取聊天消息</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/040Vulnhub - Mr. Robot CTF Video Walkthrough/">Vulnhub - Mr. Robot CTF Video Walkthrough</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/039sublime-rumen /">如何优雅地使用sublime</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/032weijizhan-forensics/">伪基站鉴定相关要点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/031kali-forensics/">kali计算机取证——安全牛</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/037change-vps-time /">vps修改时区</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/036yijuhua /">一句话木马</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/035lshack /">lshack拿站实例</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/22/034ddos-tools /">ddos相关工具</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.douban.com/" title="douban" target="_blank">douban</a><ul></ul><a href="http://www.v2ex.com/" title="v2ex" target="_blank">v2ex</a><ul></ul><a href="http://www.github.com/" title="github" target="_blank">github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">hack70.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>